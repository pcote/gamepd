<html>
<head>
<title>Uncle Squirrely's Games</title>
<meta name="keywords" content= "games, video games, wii, Nintendo, Playstation 3, PS3, XBox 360, console games" >




<script type = "text/javascript" src = "jquery.js"></script>
<script type = "text/javascript" src = "thickbox.js"></script>
<link rel = "stylesheet href = "css/blemish/style.css" type = "text/css" />
<link rel = "stylesheet" href="thickbox.css" type = "text/css" media = "screen" />


<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-10592193-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type="text/javascript">

var rightKey = 39;
var leftKey = 37;

function nextPage( pageDirection ){
	var pageNum = (document.formCurrentState.hiddenPageNum.value) * 1;
	var maxPage = (document.getElementById( "hiddenPageMax" ).value) * 1;

	
	var startRec = 0;
	var endRec = 10;
	
	var leftArrow = document.getElementById( "leftArrow" );
	var rightArrow = document.getElementById( "rightArrow" );

	if( pageDirection == 'next' ){
		leftArrow.style.visibility = "visible";
		currentPage = document.getElementById( "hiddenPageNum" ).value * 1;
		
		if( currentPage <= maxPage )
			document.formCurrentState.hiddenPageNum.value = pageNum + 1;
	}

	else if( pageDirection == 'previous' ){
		document.formCurrentState.hiddenPageNum.value = pageNum - 1;
	}

	// safety check to ensure you don't go off into zeros and negative land with the paging.
	if( document.formCurrentState.hiddenPageNum.value == '0' ){
		document.formCurrentState.hiddenPageNum.value = 1;
		
	}

	// manage the navigation arrows.  (start with updated versions of page num values.)
	pageNum = (document.formCurrentState.hiddenPageNum.value) * 1;
	maxPage = (document.getElementById( "hiddenPageMax" ).value) * 1;
	if( pageNum <= 1 )
		leftArrow.style.visibility="hidden";
	else
		leftArrow.style.visibility="visible";
	
	if( pageNum > maxPage )
		rightArrow.style.visibility="hidden";
	else
		rightArrow.style.visibility="visible";

	loadGameData( 'current', 'current' );
	
}

function keyTest( evt ){
	if( evt.which == rightKey )
			nextPage( 'next' );
	else if( evt.which == leftKey )
		nextPage( 'previous' );
}

function getPageCount( platform ){
	var pageCount = 1;
	var requrl = "page_count.php?platform="+platform;
	$(document).ready(
		function(){ /* went down to ajax because there was no specific component to select at jquery level */
			ajaxResults = $.ajax( { url:requrl, async:false} );
			$(":input[name=hiddenPageMax]").val( ajaxResults.responseText );
		}
	);

}

function loadGameData( platform, order ){
	
	
	if( platform != order )
		document.formCurrentState.hiddenPageNum.value = 1;
		
	if( platform == 'current' )
		platform = document.formCurrentState.hiddenPlatform.value;
	if( order == 'current' )
		order =  document.formCurrentState.hiddenOrder.value;

	
	getPageCount(platform);
	
	var requrl = "game_table.php?platform=" + platform + "&order=" + order + "&pagenum=" + document.formCurrentState.hiddenPageNum.value;
	$(document).ready( function(){
		$('#gametableid').load( requrl );
	} );

	document.formCurrentState.hiddenPlatform.value = platform;
	document.formCurrentState.hiddenOrder.value = order;
	
}

function loadYoutubeVideo( gameTitle, linkID ){

	var linkElem = document.getElementById( linkID );
	var platform = document.formCurrentState.hiddenPlatform.value;
	var reqURL = "get_random_video.php?platform=" + platform + "&title=" + escape( gameTitle );
	var youtubeAddress = "";

	$(document).ready(
		function(){
			ajaxResults = $.ajax( { url:reqURL, async:false} );
			youtubeAddress = ajaxResults.responseText + "&TB_iframe=true&height=400&width=410";
			linkElem.href= youtubeAddress;
			window.location = youtubeAddress;
		}
	);


}

document.onkeydown=keyTest;
</script>
</head>

<body onload="loadGameData( 'wii', 'last_updated' )">
<center>

<table width="80%">
<div id="title"><img src = "image/us_logo.png" /></div><br />
</table>

<table width="80%">
<tr><td id="blank_id" align="center">
<a href = "javascript:loadGameData( 'ps3', 'current' )">Playstation 3</a>&nbsp;&nbsp;&nbsp;
<a href = "javascript:loadGameData( 'xbox360', 'current' )">XBox 360</a>&nbsp;&nbsp;&nbsp;
<a href = "javascript:loadGameData( 'wii', 'current' )">Wii</a><br />

<a href = "javascript:loadGameData( 'current', 'last_updated' )">Show Latest Drops</a>&nbsp;&nbsp;&nbsp;
<a href = "javascript:loadGameData( 'current', 'cheap' )">Show Cheapest</a> &nbsp;&nbsp;&nbsp;
<a href = "javascript:loadGameData( 'current', 'alpha' )">Alphabetize Them</a> &nbsp;&nbsp;&nbsp;
<a href = "javascript:loadGameData( 'current', 'release' )">Show Newest</a>
</td></tr>
</table>

</center>

<center>
<table width="80%">
<tr>
<td align='right' width="5%">
<div id="leftArrow" style="visibility:hidden;"><a href = "javascript:nextPage(  'previous' )" onKeydown="keyTest"> &lt;&lt;</a>  &nbsp;&nbsp;</div>
</td>
<td align='center'><div id = "gametableid"></div></td>
<td align='left' width="5%">
<div id="rightArrow"><a href = "javascript:nextPage( 'next' )"> &gt;&gt; </a></div>
</td>
</table>
</center>

<form name = "formCurrentState">
	<input type = "hidden" name = "hiddenPlatform" value = "ps3"/>
	<input type = "hidden" name = "hiddenOrder" value = "last_updated"/>
	<input type = "hidden" name = "hiddenPageNum" id="hiddenPageNum" value = "1" />
	<input type = "hidden" name = "hiddenPageMax" id="hiddenPageMax" />
</form>
</body>
</html>
